{% extends 'base.html' %} 
{% block title %}품종별 무게 분포{% endblock %} 
{% block content %}

<style>
  .chart-container {
    margin: 20px;
    padding: 20px;
  }
  
  .chart-container h2 {
    color: #333;
    margin-bottom: 20px;
    font-size: 28px;
  }
  
  #chartDiv {
    width: 100%;
    height: 600px;
  }
</style>

<div class="chart-container">
  <h2>품종별 무게 분포</h2>
  <div id="chartDiv"></div>
</div>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script>
  // Get data from Flask
  const chartData = {{ chart_data | tojson }};
  
  // Group data by code_desc
  const groupedData = {};
  chartData.forEach(row => {
    if (!groupedData[row.code_desc]) {
      groupedData[row.code_desc] = [];
    }
    groupedData[row.code_desc].push(row.raw_weight);
  });
  
  // Prepare traces for Plotly
  const traces = Object.keys(groupedData).map(breed => ({
    y: groupedData[breed],
    type: 'box',
    name: breed,
    boxmean: 'sd'
  }));
  
  // Layout configuration
  const layout = {
    title: '품종별 무게 분포',
    yaxis: {
      title: '중량(g)'
    },
    xaxis: {
      title: '품종'
    },
    showlegend: false,
    plot_bgcolor: '#f9f9f9',
    paper_bgcolor: 'white'
  };
  
  // Create the plot
  Plotly.newPlot('chartDiv', traces, layout);
</script>

{% endblock %}
